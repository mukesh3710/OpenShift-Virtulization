### SDN

- OpenShift uses a software-defined networking (SDN) model to manage communication between pods, services, and nodes. When you install OpenShift (using IPI or UPI), you configure three key networks (Cluster Network, Machine Network & Service Network)
- Cluster Network: Internal network for Pods to communicate with each other across nodes. Every Pod gets an IP from this range, and SDN/OVN-Kubernetes handles Pod A on Node1 → Pod B on Node2 uses Cluster Network (routing.CIDR: 10.128.0.0/14)
- Machine Network: Network for the nodes themselves (control plane and worker nodes) to communicate with each other and with the outside world. Set during install; must include all node IPs. 
- Service Network: Virtual network for Kubernetes Services (ClusterIP) to expose applications internally. Pods talk to Services via this network using kube-proxy.
- How They Work Together
  - Each node connects to OVS bridge (br-ex) linked to Machine Network.
  - Pods/VMs get IP from Cluster Network (overlay via Geneve tunnels).
  - Services provide load balancing + DNS inside cluster.
- Additional Interfaces (Data Network): You can add another physical interface → create OVS bridge (br-data) → attach VLANs for advanced networking (via NetworkAttachmentDefinition CRDs). Example: VM on VLAN 10 gets IP 192.168.10.x and is accessible externally without NAT.
---
Underlay vs Overlay:
- Underlay Network: Physical network using VLANs (e.g., 192.168.122.0/24) for node connectivity. VLAN 100 for nodes (physical VLAN).
- Overlay Network: Virtual network (e.g., Geneve or VXLAN) on top of underlay for Pods/VMs communication. Scalable, avoids VLAN limits. Cluster Network 10.128.0.0/14 for Pods via Geneve tunnels (Cluster Network).
---
Pod and Service Networking: 
- Pods: Each Pod gets an IP from the Cluster Network (e.g., 10.128.0.12). Pods can directly talk to each other across nodes. Example: Pod A (10.128.0.12) → Pod B (10.128.1.8)
- Services: A Service gets a virtual IP from the Service Network (e.g., 172.30.100.50) and acts as an internal load balancer for Pods. DNS (e.g., myapp.default.svc.cluster.local) resolves to this IP. Example: Pod A → Service (172.30.100.50) → routes to backend Pods.
- Why Service Network Exists: Pod IPs are ephemeral, so Service Network provides stable IP and DNS for apps. Example: myapp.default.svc.cluster.local → 172.30.100.50.
---
External Access: 
- NodePort: Exposes service on each node’s IP at a static port (e.g., NodeIP:30080).
- LoadBalancer: Uses external load balancer (cloud or MetalLB) for single IP.
- Ingress/Route (OpenShift): Provides HTTP/HTTPS access via DNS (e.g., https://myapp.apps.example.com).
